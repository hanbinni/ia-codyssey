# Mars Pirate Log Server

간단한 HTTP 서버를 구현하여 `index.html` 페이지를 제공하고, 접속자의
**IP 주소**와 **위치 정보**를 출력하는 프로그램입니다.\

------------------------------------------------------------------------

## 🚀 실행 방법

1.  저장소/프로젝트 디렉토리에서 서버 실행:

    ``` bash
    python3 server.py
    ```

2.  서버가 시작되면:

        서버 시작: http://localhost:8080

3.  웹 브라우저에서 `http://localhost:8080` 접속 → `index.html` 페이지
    확인 가능

4.  ngrok을 이용한 외부 접속 (사전에 ngrok 설치 필요):

    ``` bash
    ngrok http 8080
    ```

    출력되는 `https://xxxx.ngrok.io` 주소로 외부에서 접근 가능

------------------------------------------------------------------------

## 🖥️ 작동 방식

-   페이지 접속 시 `index.html` 내용이 출력되고, 하단에 **접속자의 IP와
    위치 정보**가 표시됩니다.
-   서버 콘솔에는 다음 로그가 남습니다:
    -   접속 시간
    -   클라이언트 IP 주소
    -   위치 정보 (ipinfo.io API 기반)

예시 로그:

    [2025-09-18 16:00:12] 클라이언트 접속 - IP: 210.xxx.xxx.xxx, 위치: KR Seoul Seoul / AS3786 LG DACOM Corporation

------------------------------------------------------------------------

## 📂 코드 설명

### server.py

-   **HTTPServer, BaseHTTPRequestHandler**\
    파이썬 내장 모듈 `http.server`를 이용해 HTTP 서버를 구현

-   **PirateHandler.do_GET**

    -   클라이언트의 GET 요청을 처리
    -   `favicon.ico` 요청은 무시
    -   `index.html`을 읽어 클라이언트에게 응답
    -   응답 하단에 접속 IP, 위치 정보 추가
    -   200 OK 헤더를 반환

-   **get_client_ip()**

    -   우선 `X-Forwarded-For` 헤더 확인 (ngrok, 로드밸런서 환경용)
    -   없으면 `self.client_address[0]` 사용 (일반 직접 접속)

-   **get_location_info(ip)**

    -   `ipinfo.io` API를 호출해 해당 IP의 국가, 지역, 도시, 통신사(ASN)
        정보를 가져옴
    -   로컬 IP(127.x, 192.168.x, 10.x)는 조회하지 않음

-   **run_server()**

    -   포트 8080에서 서버 실행
    -   `Ctrl + C` 로 종료 가능


------------------------------------------------------------------------

## ⚠️ 주의 사항

-   위치 정보 조회를 위해 `ipinfo.io` API를 사용 (무료 버전은 요청 제한
    있음)
-   외부 공개 시 반드시 **ngrok** 또는 **퍼블릭 서버** 환경에서 테스트
-   로컬 접속 시에는 위치 정보가 표시되지 않을 수 있음 (사설망 IP는 조회
    불가)

------------------------------------------------------------------------
